---
title: "Initial EDA Basic Outline"
author: "Guilherme Lima"
output: html_notebook
---

This is an outline for your Initial EDA. You can follow this outline, or you can modify it as you see fit. Do what works best for your project. 

## Research Question 

State your specific research question and why it is interesting. 



## Data Processing 

#### Data Intake 

Include R code and written explanation to import your **TWO** data sets.
```{r}
library(tidyverse)
results <- read.csv("results.csv")
drivers <- read.csv("drivers.csv")
races <- read.csv("races.csv")
circuits <- read.csv("circuits.csv")
```




#### Data Wrangling 

Include R code and written explanation for wrangling your data (you can make multiple wrangled data sets). 
```{r}
circuits <- circuits %>% select(circuitId, name)
drivers <- drivers %>% select(driverId, driverRef)  



currentRaces <- races %>% filter(year >= 2010 & year <= 2022)
races <- currentRaces %>% select(raceId, circuitId, year)
results <- results %>% select(raceId,driverId, points)
```

```{r}
joined_1 <- right_join(races, circuits, by = "circuitId")
joined_1 <- drop_na(joined_1)

joined_2 <- right_join(results, drivers, by = "driverId")
joined_2 <- drop_na(joined_2)

joined_3 <- full_join(joined_1, joined_2, by = "raceId")
joined_3 <- drop_na(joined_3)
```



```{r}
test <- joined_3 %>% group_by(name, driverId, year) %>% arrange(driverId, circuitId)


analysis2 <- joined_3 %>% group_by(driverRef, name) %>% summarise(totalPoints = sum(points), numRaces = n()) %>%
mutate(averagePoints = totalPoints/ numRaces) %>%
  arrange(desc(averagePoints))

analysis3 <- joined_3 %>% group_by(driverRef, name, circuitId) %>% summarise(totalPoints = sum(points), numRaces = n()) %>%
mutate(averagePoints = totalPoints/ numRaces) %>%
  arrange(desc(totalPoints))

analysis4 <- analysis3 %>% filter(numRaces > 10 ) %>% group_by(driverRef) %>% arrange(driverRef, desc(averagePoints)) 


maxAveragePoints <- analysis4 %>%
  group_by(name) %>%
  filter(averagePoints == max(averagePoints)) %>%
  ungroup() %>%
  select(name, driverRef, averagePoints)
```



## Data Visualization

#### Plot 1

Include R code to make one data visualization (I would encourage you to use 3 or more variables). Include a brief written description of what your graph shows. Is this graph helpful in answering your research question? If it is helpful, will you need to add/modify anything in this graph in the final report? 

```{r}
analysis4 %>% ggplot(aes(x=averagePoints, y=name)) + geom_point(aes(color=driverRef))

```


#### Plot 2

```{r}
maxAveragePoints %>%
  ggplot(aes(x = averagePoints, y = name, color = driverRef)) +
  geom_point(shape = "circle", size = 2.0) 
```


## Conclusion

Include your initial intuition as to what the answer to your research question is using the data sets and visualizations you created. 